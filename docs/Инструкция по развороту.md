# Инструкция по развороту приложения

## Минимальные требования

-   Диск: 15 Гб
-   ОЗУ: 1 Гб
-   Ubuntu 22.04 LTS
-   1 ядро
-   Docker

## Шаги по запуску

1. Для начала нужно склонировать проект с удаленного репозитория командой `git clone <url_репозитория>` и перейти в созданную папку и в директорию **src**, где лежит исходный код системы `cd <название_проекта>/src`.
1. <a id="step-run-restart"></a> Релизные версия находятся в ветке `main`, поэтому, если не требуется иного, нужно остаться в текущей ветке. В противном случае командой `git checkout <название_ветки>` можно перейти на требуемую ветку.
1. При необходимости следует настроить **.env** файл, инструкция по его настройке описана в разделе [Инструкция по настройки .env](#инструкция-по-настройки-env).
1. Далее следует запустить сборку и запуск приложения командой `docker-compose up`. Docker автоматически соберет и запустит необходимые образы.
1. Поздравляем, проект успешно запущен!

## Шаги по применению изменений

1. Для начала необходимо остановить работу всех контейнеров командой `docker stop $(docker ps -aq)`.
1. Далее требуется удалить образы контейнеров **backend**, **frontend** и **nginx** командой `docker rm frontend backend nginx`.
1. Необходимо подтянуть изменения с удаленного репозитория командой `git pull` из папки с проектом.
1. Далее выполнить шаги с [№2](#step-run-restart) из раздела [Шаги по запуску](#шаги-по-запуску).

## Инструкция по настройки .env

В проекте существует 2 **.env** файла: общий (располагается в директории `src`) и клиентский (располагается в директории `src/frontend`). В продакт-версии рекомендуется изменять только общий.

Общий **.env** файл содержит следующие переменные:

-   `PG_HOST` - адрес хоста базы данных (используется в контейнере **backend**)
-   `PG_USER` - пользователь базы данных (используется в контейнерах **backend** и **postgres**)
-   `PG_PASSWORD`- пароль от пользователя базы данных (используется в контейнерах **backend** и **postgres**)
-   `PG_DB` - название базы данных (используется в контейнерах **backend** и **postgres**)
-   `PG_PORT` - порт базы данных (используется в контейнерах **backend** и **postgres**)
-   `BACK_PORT` - порт серверной части (используется в контейнерах **backend** и **nginx**)
-   `BACK_HOST` - адрес хоста, на котором запускается серверная часть (используется в контейнере **nginx**)
-   `ALLOWED_HOSTS` - адреса хостов, котороые могут обращаться к серверной части (используется в контейнере **backend**)
-   `NGINX_PORT` - порт сервиса Nginx (используется в контейнере **nginx**)

Клиентский **.env** файл содержит одну переменную:

-   `VITE_API_BASE_URL` - адрес, на который будет ссылаться фронт (по умолчанию, лучше оставить `/api`, т.к. таким образом клиент не завязывается на конкретные хосты, этим занимается nginx).
